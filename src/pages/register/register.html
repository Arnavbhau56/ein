<div class="register-heading">REGISTER</div>
<div class="register-card">
  <!-- Progress Bar -->
  <div class="progress-container">
    <div class="progress-bar">
      <div class="progress-step" [class.active]="currentPage >= 1" [class.completed]="currentPage > 1">
        <div class="step-number">1</div>
        <div class="step-label">EMAIL VERIFICATION</div>
      </div>
      <div class="progress-line" [class.completed]="currentPage > 1"></div>
      <div class="progress-step" [class.active]="currentPage >= 2" [class.completed]="currentPage > 2">
        <div class="step-number">2</div>
        <div class="step-label">FOUNDERS' INFORMATION</div>
      </div>
      <div class="progress-line" [class.completed]="currentPage > 2"></div>
      <div class="progress-step" [class.active]="currentPage >= 3">
        <div class="step-number">3</div>
        <div class="step-label">STARTUP INFORMATION</div>
      </div>
    </div>
  </div>

  <!-- Page 1: Email Verification -->
  <form *ngIf="currentPage === 1" class="register-form" autocomplete="off">
    <div class="input-group input-row">
      <div class="input-col">
        <label for="email">Email <span class="star">*</span></label>
        <input type="email" id="email" [(ngModel)]="formData.email" name="email" required autocomplete="off" />
      </div>
      <button class="btn send-otp-btn" type="button" (click)="showResend ? resendOtp() : sendOtp()" [disabled]="otpSent && !showResend">
        <ng-container *ngIf="otpSent">
          <ng-container *ngIf="!showResend">Wait {{ timer }}s</ng-container>
          <ng-container *ngIf="showResend">Resend OTP</ng-container>
        </ng-container>
        <ng-container *ngIf="!otpSent">Send OTP</ng-container>
      </button>
    </div>
    <div class="input-group otp-group">
      <label>OTP <span class="star">*</span></label>
      <div class="otp-boxes">
        <input *ngFor="let digit of otpDigits; let i = index; trackBy: trackByIndex" maxlength="1" type="text" class="otp-input" [(ngModel)]="otpDigits[i]" [name]="'otp' + i" [ngModelOptions]="{standalone: true}" #otpInput
          (input)="onOtpInput(i, $event)" (keydown)="onOtpKeydown(i, $event)" (paste)="onOtpPaste($event)" required />
      </div>
    </div>
    <div class="form-actions">
      <button class="btn next-btn" type="button" (click)="nextPage()">Next</button>
    </div>
  </form>

  <!-- Page 2: Founders' Information -->
  <form *ngIf="currentPage === 2" class="register-form">
    <div class="form-row">
      <div class="input-group">
        <label for="firstName">First Name <span class="star">*</span></label>
        <input type="text" id="firstName" [(ngModel)]="formData.first_name" name="firstName" required />
      </div>
      <div class="input-group">
        <label for="lastName">Last Name <span class="star">*</span></label>
        <input type="text" id="lastName" [(ngModel)]="formData.last_name" name="lastName" required />
      </div>
    </div>
    <div class="form-row">
      <div class="input-group">
        <label for="gender">Gender <span class="star">*</span></label>
        <select id="gender" [(ngModel)]="formData.gender" name="gender" required>
          <option value="">Select Gender</option>
          <option *ngFor="let option of genderOptions" [value]="option.value">{{ option.viewValue }}</option>
        </select>
      </div>
      <div class="input-group">
        <label for="countryCode">Country Code <span class="star">*</span></label>
        <div class="custom-select-wrapper">
          <input type="text" id="countryCode" [(ngModel)]="formData.country_code" name="countryCode"
            (input)="filterCountryCodes(formData.country_code)" (focus)="showCountryDropdown = true" (blur)="hideCountryDropdown()"
            placeholder="Select or search country code" required autocomplete="off" />
          <ul class="custom-select-dropdown" *ngIf="showCountryDropdown && filteredCountriesList.length">
            <li *ngFor="let country of filteredCountriesList" (mousedown)="selectCountryCode(country)">
              {{ country.flag }} +{{ country.countryCallingCode }} ({{ country.countryNameEn }})
            </li>
          </ul>
        </div>
      </div>
      <div class="input-group">
        <label for="contactNumber">Contact Number <span class="star">*</span></label>
        <input type="text" id="contactNumber" [(ngModel)]="formData.contact_number" name="contactNumber" required maxlength="16" pattern="[0-9]*" />
      </div>
    </div>
    <div class="form-row">
      <div class="input-group">
        <label for="country">Country <span class="star">*</span></label>
        <input type="text" id="country" [(ngModel)]="formData.country" name="country" required />
      </div>
    </div>
    <div class="form-row" *ngIf="formData.country?.toLowerCase() === 'india'">
      <div class="input-group">
        <label for="postalCode">Postal Code <span class="star">*</span></label>
        <input type="text" id="postalCode" [(ngModel)]="formData.postal_code" name="postalCode" (input)="onPostalCodeInput()" (blur)="onPostalCodeChange()" maxlength="6" minlength="6" required />
      </div>
      <div class="input-group">
        <label for="state">State <span class="star">*</span></label>
        <input type="text" id="state" [(ngModel)]="formData.state" name="state" required [readonly]="postalCodeAutoFilled" />
      </div>
      <div class="input-group">
        <label for="city">City <span class="star">*</span></label>
        <input type="text" id="city" [(ngModel)]="formData.city" name="city" required [readonly]="postalCodeAutoFilled" />
      </div>
    </div>
    <div class="form-row">
      <div class="input-group">
        <label for="linkedin">LinkedIn URL <span class="star">*</span></label>
        <input type="url" id="linkedin" [(ngModel)]="formData.linkedin_url" name="linkedin" required />
      </div>
    </div>
    <div class="form-actions">
      <button class="btn prev-btn" type="button" (click)="previousPage()">Previous</button>
      <button class="btn next-btn" type="button" (click)="nextPage()">Next</button>
    </div>
  </form>

  <!-- Page 3: Startup Information -->
  <form *ngIf="currentPage === 3" class="register-form">
    <div class="input-group">
      <label for="startupName">Startup Name <span class="star">*</span></label>
      <input type="text" id="startupName" [(ngModel)]="formData.startup_name" name="startupName" required />
    </div>
    <div class="input-group">
      <label for="startupSector">Startup Sector <span class="star">*</span></label>
      <select id="startupSector" [(ngModel)]="formData.startup_sector" name="startupSector" required>
        <option value="">Select Sector</option>
        <option *ngFor="let option of sectorOptions" [value]="option.value">{{ option.viewValue }}</option>
      </select>
    </div>
    <div class="input-group">
      <label for="dpiitRegistered">Is your startup DPIIT Registered? <span class="star">*</span></label>
      <select id="dpiitRegistered" [(ngModel)]="formData.dpiit_registered" name="dpiitRegistered" required>
        <option value="">Select Option</option>
        <option value="yes">Yes</option>
        <option value="no">No</option>
      </select>
    </div>
    <div class="input-group" *ngIf="formData.dpiit_registered === 'yes'">
      <label for="dpiitNumber">DPIIT Recognition Number <span class="star">*</span></label>
      <input type="text" id="dpiitNumber" [(ngModel)]="formData.dpiit_recognition_number" name="dpiitNumber" required />
    </div>
    <div class="input-group">
      <label for="startupDescription">Startup Description <span class="star">*</span></label>
      <textarea id="startupDescription" [(ngModel)]="formData.startup_description" name="startupDescription" required></textarea>
    </div>
    <div class="input-group">
      <label for="startupTraction">Startup Traction <span class="star">*</span></label>
      <textarea id="startupTraction" [(ngModel)]="formData.startup_traction" name="startupTraction" required></textarea>
    </div>
    <div class="input-group">
      <label for="startupStage">Current Registration Status <span class="star">*</span></label>
      <select id="startupStage" [(ngModel)]="formData.startup_stage" name="companyRegStatus" required>
        <option value="">Select Stage</option>
        <option *ngFor="let option of startupStageOptions" [value]="option.value">{{ option.viewValue }}</option>
      </select>
    </div>
    <div class="input-group">
      <label for="startupWebsite">Startup Website</label>
      <input type="url" id="startupWebsite" [(ngModel)]="formData.startup_website" name="startupWebsite" />
    </div>
    <div class="input-group">
      <label for="pitchdeck">Pitchdeck (PDF) <span class="star">*</span></label>
      <input type="file" id="pitchdeck" (change)="onPitchdeckChange($event)" accept="application/pdf" required />
    </div>
    <div class="form-actions">
      <button class="btn prev-btn" type="button" (click)="previousPage()">Previous</button>
      <button class="btn submit-btn" type="button" (click)="submit()">Submit</button>
    </div>
  </form>
</div>
